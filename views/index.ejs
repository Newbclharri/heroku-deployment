<!DOCTYPE html>
<html class="index_ejs" lang="en">
    <head>
        <%- include("./partials/head.ejs") %>
    </head>
    <body>
        <%- include("./partials/header.ejs") %> 
        <main>
            <section class="add-params">                
                <form action="/skill" method="post">
                    <input type="text" name="skill" placeholder="skill">
                    <input type="text" name="resource" placeholder="resource">
                    <input type="submit" value="Add">
                </form>
            </section>
            <section class="display-skills"> 
                <script>
                    const skills = <%- JSON.stringify(skills)%>
                    const forms = document.querySelectorAll("form")
                    console.log(skills)
                    let inputCheck = null;
                    let button = null;
                </script>
                <% for(i = 0; i < skills.length; i++) {%>

                    <div class="actions-conatiner">
                        <form action="" id="ed<%= skills[i]._id %>" class="action">
                            <input type="submit" value="edit" class="action-input">
                        </form>
                        <form action="/<%= skills[i]._id %>?_method=DELETE" method="post" class="action">
                            <input type="submit" value="delete" class="action-input">
                        </form>
                    </div>
                                        
                    <form name="<%=i%>" id="<%=i%>" action="/<%= skills[i]._id %>?_method=PUT" method="post" class="container">
                        
                        <input class="checkbox" onChange="formSubmit(<%=i%>)"
                        type="checkbox" name="checkbox" id="<%= skills[i]._id %>">
                            <a href="<%= skills[i].resource %>" target="blank"> <div class="skill <%= skills[i].completed ? 'checked' : null %>"><%= skills[i].text %></div></a>
                            <script>
                                function formSubmit(num){
                                    document.getElementById(num).submit()
                                    let formEdit = document.getElementById(`ed${skills[<%=i%>]._id}`)
                                }
                            </script>
                            <% if(skills[i].completed) {%>
                            <script>
                                inputCheck = document.getElementById(`${skills[<%=i%>]._id}`)
                                // console.log(input)
                                inputCheck.setAttribute("checked","checked")                               
                            </script>                          
                        <span class="checkmark"></span>
                    </form>                   
                        <%} %>                        
                        
                <%} %>                            
            </section>
            <br>
            <div class="divider"></div>
            <br>
            <section class="journal-section">
                <h1>Journals:</h1>
            </section>
        </main>         
    </body>
</html>